UserParameter=one.collect[*],bash -o 'pipefail' -c 'HOME=/var/lib/zabbix/ one$1 list -x 2> /dev/null > /tmp/one$1.out && echo 0 || echo 1'
UserParameter=one.parse[*],xmllint --xpath "//HOST_POOL/HOST/ID|//HOST_POOL/HOST/HOST_SHARE/MEM_USAGE" /tmp/onehost.out | sed 's/<[^<]*>/\n/g' | sed '/^$/d' | paste - - | grep '^$1 ' |
UserParameter=one.host.stat[*],xmlstarlet sel -t -c '//HOST_POOL/HOST/ID/text()|//HOST_POOL/HOST/HOST_SHARE/'$(echo "$1" | tr /a-z/ /A-Z/) /tmp/onehost.out | sed -e 's/<[^/<]*>/\t/g' -e 's/<\/[^<]*>/\n/g' | awk '{ if( "$2" == "" ) {sum+=$ 2} else {if($ 1 == "$2") {print $ 2}}} END { if( "$2" == "" ) { printf("%.0f", sum/NR) }}'