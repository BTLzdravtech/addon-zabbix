UserParameter=one.collect[*],bash -o 'pipefail' -c 'HOME=/var/lib/zabbix/ one$1 list -x 2> /dev/null > /tmp/one$1.out && echo 0 || echo 1'
UserParameter=one.host.stat[*],xmlstarlet sel -t -c '//HOST_POOL/HOST/ID/text()|//HOST_POOL/HOST/HOST_SHARE/'$(echo "$1" | tr /a-z/ /A-Z/) /tmp/onehost.out | sed -e 's/<[^/<]*>/\t/g' -e 's/<\/[^<]*>/\n/g' | awk '{ if( "$2" == "avg" || "$2" == "sum" || "$2" == "" ) {sum+=$ 2} else {if($ 1 == "$2") {print $ 2}}} END { if( "$2" == "avg" ) { printf("%.0f", sum/NR) } if( "$2" == "" || "$2" == "sum") { printf("%.0f", sum) } }'
UserParameter=one.host.state[*],xmlstarlet sel -t -c '//HOST_POOL/HOST/ID/text()|//HOST_POOL/HOST/STATE' /tmp/onehost.out | sed -e 's/<[^/<]*>/\t/g' -e 's/<\/[^<]*>/\n/g' | awk '{enabled=2; update=1; disabled=4; offline=8; error=3}{ if( $ 2 == $1 ){print $ 1} }' | wc -l
UserParameter=one.vm.state[*],xmlstarlet sel -t -c '//VM_POOL/VM/ID/text()|//VM_POOL/VM/STATE|//VM_POOL/VM/LCM_STATE' /tmp/onevm.out | sed -e 's/<\/LCM_STATE>/\n/g' -e 's/\(<[^<]*>\)\{1,\}/\t/g' -e 's/\t\t//' | awk '{init=0; pending=1; hold=2; active=3; stopped=4; suspended=5; poweroff=8; undeployed=9; clonning=10}{ if( $ 2 == $1 ){print $ 1 $3} }' | wc -l